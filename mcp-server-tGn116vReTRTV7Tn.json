{"createdAt":"2025-06-25T20:05:17.134Z","updatedAt":"2025-09-07T14:26:45.457Z","id":"tGn116vReTRTV7Tn","name":"MCP Server","active":false,"isArchived":true,"nodes":[{"parameters":{"path":"turno-mcp"},"type":"@n8n/n8n-nodes-langchain.mcpTrigger","typeVersion":2,"position":[-1088,280],"id":"7bad2bf3-042a-4dac-9bac-7c84005e3a68","name":"MCP Server Trigger","webhookId":"a4de276a-65cc-48ed-b241-a3a7d2f33dbe"},{"parameters":{"description":"Llama a este subflujo cuando se necesita saber los horarios disponibles de un medico","workflowId":{"__rl":true,"value":"kmoVJGP4RL3PTi16","mode":"list","cachedResultName":"Sub-flujo - Horarios_pacientes-mes"},"workflowInputs":{"mappingMode":"defineBelow","value":{"matricula":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('matricula', `Matricula del medico encontrada desde obtener_medicos_especialidades o pgvector\n\nEs unicamente un dato de tipo NUMBER`, 'number') }}"},"matchingColumns":["matricula"],"schema":[{"id":"matricula","displayName":"matricula","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-1300,500],"id":"4a4ff52c-1323-47b6-9efe-fa4939bf14a9","name":"horarios_medicos_disponibles"},{"parameters":{"description":"Confirma un turno médico para el paciente. Requiere DNI, matrícula del médico, fecha y hora. Convierte automáticamente los formatos de fecha (a timestamp) y hora (a HHMM) para la API.","workflowId":{"__rl":true,"value":"H4tsNj9SnsCxET4y","mode":"list","cachedResultName":"ICLP - Subflujo_Tomar_Turno"},"workflowInputs":{"mappingMode":"defineBelow","value":{"dni":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('dni', `Documento/DNI proporcionado por el paciente`, 'number') }}","matricula":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('matricula', `matricula del medico que va a obtener el turno`, 'number') }}","fecha":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fecha', `El dia que el paciente quiere el turno`, 'string') }}","hora":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('hora', `La hora que el paciente quiere el turno`, 'string') }}","nombre_completo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nombre_completo', `nombre completo del paciente que va a tomar el turno`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"dni","displayName":"dni","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false},{"id":"fecha","displayName":"fecha","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false},{"id":"matricula","displayName":"matricula","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false},{"id":"hora","displayName":"hora","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false},{"id":"nombre_completo","displayName":"nombre_completo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-1180,500],"id":"dd6393e7-041f-4e14-8cc3-cea306b65368","name":"tomar_turno_paciente"},{"parameters":{"toolDescription":"Lista los turnos actuales de un paciente por DNI.Si la fecha es 8/07/2025 transformarla a 20250708","url":"http://iclp.ddns.net:7080/ws-turnos-rest-simple/api/turnos/lista-turnos-actuales","sendQuery":true,"queryParameters":{"parameters":[{"name":"usuario","value":"=WSTRRED"},{"name":"password","value":"=Y2xpb25lcw"},{"name":"dni","value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters2_Value', `Documento de identidad proporcionado por el paciente`, 'string') }}"},{"name":"fecha","value":"={{ $now.setZone('America/Argentina/Buenos_Aires').toFormat('yyyyLLdd') }}"}]},"options":{},"optimizeResponse":true,"dataField":"lista","fieldsToInclude":"selected","fields":"fecha, fechaString, hora, hora5digitos, matricula, nombreMedico, estudios,"},"type":"n8n-nodes-base.httpRequestTool","typeVersion":4.2,"position":[-1060,500],"id":"31d08031-5914-42e0-9254-95e5ddef654f","name":"HTTP Lista_Turnos"},{"parameters":{"toolDescription":"Permite cancelar un turno médico existente. Requiere la matrícula del médico, la fecha (en formato YYYYMMDD, ej: '20250708') y la hora (en formato HHMM, ej: '1430') del turno a eliminar. Asegúrate de obtener estos tres datos precisos del paciente antes de usar esta herramienta.","method":"PUT","url":"http://iclp.ddns.net:7080/ws-turnos-rest-simple/api/turnos/eliminar-turno","sendQuery":true,"queryParameters":{"parameters":[{"name":"usuario","value":"WSTRRED"},{"name":"password","value":"Y2xpb25lcw"},{"name":"matricula","value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters2_Value', `Matricula del medico, generalmente son 5 a 7 numeros. \nTe puedes guiar por parameters2_Value:\n111808\n`, 'string') }}"},{"name":"fecha","value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters3_Value', `Es la fecha del turno\nTe puedes guiar por\nparameters3_Value:\n20250721`, 'string') }}"},{"name":"hora","value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters4_Value', `Es la hora del turno te puedes guiar por\nparameters4_Value:\n1040`, 'string') }}"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"}]},"options":{}},"type":"n8n-nodes-base.httpRequestTool","typeVersion":4.2,"position":[-940,500],"id":"eedd6591-7d25-408d-8ce4-2cc6e19c379b","name":"HTTP eliminar_Turno"},{"parameters":{"databaseId":256795,"tableId":606371,"returnAll":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', `La lista parcial o completa de especialidades medicas`, 'boolean') }}","additionalOptions":{"filters":{"fields":[{"field":4917992,"operator":"contains","value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fields0_Value', ``, 'string') }}"}]}}},"type":"n8n-nodes-base.baserowTool","typeVersion":1,"position":[-820,500],"id":"40ca2197-0c4a-4ac6-89ef-7bc967e3c0dc","name":"Obtener_especialidades","credentials":{"baserowApi":{"id":"ZpGSFHDmV88Zga8O","name":"Baserow account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[-612,700],"id":"ff510013-0586-4bea-8172-73160d571c6c","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"mE1IL02M9AnIg3tD","name":"OpenAi Credenciales ICLP"}}},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Base vectorizada de médicos. El agente puede filtrar por metadata como especialidad, obra_social y localidad.\n- NUNCA pero NUNCA devuelvas el valor de la consulta. ESO ES UN DATO INTERNO.","tableName":"iclp_datos_medicos","topK":15,"options":{"distanceStrategy":"cosine"}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[-700,502.5],"id":"a08485a2-1a8e-49ca-871a-62b792a1021c","name":"Postgres PGVector Store","credentials":{"postgres":{"id":"nsOiHzh3N4NwMXr4","name":"Postgres account - ICLP"}}}],"connections":{"horarios_medicos_disponibles":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]},"tomar_turno_paciente":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]},"HTTP Lista_Turnos":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]},"HTTP eliminar_Turno":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]},"Obtener_especialidades":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Postgres PGVector Store","type":"ai_embedding","index":0}]]},"Postgres PGVector Store":{"ai_tool":[[{"node":"MCP Server Trigger","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"2fdfee73-a026-4532-86ef-e218a5781e07","triggerCount":1,"shared":[{"createdAt":"2025-06-25T20:05:17.134Z","updatedAt":"2025-06-25T20:05:17.134Z","role":"workflow:owner","workflowId":"tGn116vReTRTV7Tn","projectId":"R66ikVn5xqf0nYcA"}],"tags":[]}